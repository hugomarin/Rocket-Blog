(function(a,t,e){"use strict";a.fn.foundationMagellan=function(e){var l=a(t),i=a(document),n=a("[data-magellan-expedition=fixed]"),o={threshold:n.length?n.outerHeight(true):0,activeClass:"active"},e=a.extend({},o,e);i.on("magellan.arrival","[data-magellan-arrival]",function(t){var l=a(this),i=l.closest("[data-magellan-expedition]"),n=i.attr("data-magellan-active-class")||e.activeClass;l.closest("[data-magellan-expedition]").find("[data-magellan-arrival]").not(this).removeClass(n);l.addClass(n)});var s=a("[data-magellan-expedition]");s.find("[data-magellan-arrival]:first").addClass(s.attr("data-magellan-active-class")||e.activeClass);n.on("magellan.update-position",function(){var t=a(this);t.data("magellan-fixed-position","");t.data("magellan-top-offset","")}).trigger("magellan.update-position");l.on("resize.magellan",function(){n.trigger("magellan.update-position")});l.on("scroll.magellan",function(){var t=l.scrollTop();n.each(function(){var l=a(this);if(l.data("magellan-top-offset")===""){l.data("magellan-top-offset",l.offset().top)}var i=t+e.threshold>l.data("magellan-top-offset");if(l.data("magellan-fixed-position")!=i){l.data("magellan-fixed-position",i);if(i){l.css({position:"fixed",top:0})}else{l.css({position:"",top:""})}}})});var r=a("[data-magellan-destination]:last");if(r.length>0){l.on("scroll.magellan",function(t){var n=l.scrollTop(),o=n+l.outerHeight(true),s=Math.ceil(r.offset().top);a("[data-magellan-destination]").each(function(){var t=a(this),l=t.attr("data-magellan-destination"),r=t.offset().top-n;if(r<=e.threshold){a("[data-magellan-arrival="+l+"]").trigger("magellan.arrival")}if(o>=i.outerHeight(true)&&s>n&&s<o){a("[data-magellan-arrival]:last").trigger("magellan.arrival")}})})}}})(jQuery,this);